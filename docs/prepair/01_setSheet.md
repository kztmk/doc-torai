---
sidebar_position: 1
---

# Google シートの設定

虎威は、Google シートの拡張機能「Apps Script」を使い X への投稿を行います。Apps Script は、トリガーと呼ばれる機能をもっています。

トリガーは、

- シートを編集
- 時間主導
- カレンダーから

と種類があり、プログラムが起動するキッカケとなります。

虎威では、時間主導トリガーを使い「1 分、5 分、10 分、15 分、30 分」から選択した間隔で投稿プログラムを実行します。

![虎威フロー](./images01/torai_flow.jpg)

投稿プログラム実行時に、投稿予約時刻をチェックしスキップ・投稿を行います。

あなたは、トリガーを「XX 分間隔」と設定することで、PC の電源を切っても Google のサーバー上で自動で実行され、Google シートにある情報が設定時刻に投稿されます。すべての投稿が完了するとトリガーが解除されます。

そのためには、Google シートの設定が必要です。この設定は**最初に一度**だけ行います。

## 設定開始！

### コードのダウンロード

まずは、Google シートの拡張機能「Apps Script」に貼り付けるコードをダウンロードします。

[コードのダウンロード](https://github.com/kztmk/x_Autopost/releases)
![Githubからダウンロードします。](./images01/github01.jpg)

ダウンロードした zip ファイルを解凍します。
![zipファイルを解凍します。](./images01/github02.jpg)

dist フォルダーにある code.js をテキストエディターで開きます。
![Githubからダウンロードします。](./images01/github03.jpg)

### Google シートの設定

次に、Google シートの設定を行います。

Chrome を開き、Google アカウントでログインを完了します。

右上のアプリアイコンをクリックし、シートを選択します。
![Googleシート01](./images01/g01.jpg)

Google シートが開きますので、「空白のスプレッドシート」を選択します。
![Googleシート02](./images01/g02.jpg)

左上のシートの名前をクリックし、自分でわかるように名前を付けます。私の場合は「X-autoposter」と付けました。
![Googleシート03](./images01/g03.jpg)

メニューから「拡張機能」-「Apps Script」を選択します。
![Googleシート04](./images01/g04.jpg)

「Apps Script」が開きますので、こちらにも名前を付けます。
![Googleシート05](./images01/g05.jpg)

名前部分をクリックすると、入力欄がポップアップしますので、名前を入力し「名前変更」をクリックします。
![Googleシート06](./images01/g06.jpg)

ファイル欄にある「コード.gs」の縦 3 点アイコンをクリックし「削除」を選択します。
![Googleシート07](./images01/g07.jpg)

確認のダイアログが表示しますので「削除」をクリックします。
![Googleシート08](./images01/g08.jpg)

ファイル欄にある「＋」アイコンをクリックし「スクリプト」を選択します。
![Googleシート09](./images01/g09.jpg)

「無題」と自動で名前が付きます。
![Googleシート10](./images01/g10.jpg)

「code」と半角英字で入力しエンターキーを押します。
![Googleシート11](./images01/g11.jpg)

エディター部分に自動で挿入されるコードを削除します。
![Googleシート12](./images01/g12.jpg)

削除した後、ダウンロードしたコードを貼り付け、「保存」ボタンをクリックします。
![Googleシート13](./images01/g13.jpg)

右上部の「デプロイ」ボタンをクリックします。
![Googleシート14](./images01/g14.jpg)

「新しいデプロイ」を選択します。
![Googleシート15](./images01/g15.jpg)

「新しいデプロイ」ダイアログが表示します。「歯車」アイコンをクリックし「ウェブアプリ」を選択します。
![Googleシート16](./images01/g16.jpg)

以下を入力、確認します。

- 説明（新しい説明）-- 自分でわかるような説明を入力します。
- ウェブアプリ（次のユーザーとして実行）-- 自分になっておりメールアドレスが合っているかを確認
- アクセスできるユーザー　-- 全員になっているかを確認

「デプロイ」ボタンをクリックします。
![Googleシート17](./images01/g17.jpg)

「アクセスを承認」ボタンをクリックします。
![Googleシート18](./images01/g18.jpg)

Google の認証が表示されますので、シートを作成した Google アカウントを確認し選択します。
![Googleシート19](./images01/g19.jpg)

「Google が認証したアプリではない！」と警告がでます。

「Advanced」リンクをクリックします。
![Googleシート20](./images01/g20.jpg)

Go to（シートにつけた名前）をクリックします。
![Googleシート21](./images01/g21.jpg)

スクリプトが実行するために必要な権限の許可が並びますので「Allow(許可)」をクリックします。
![Googleシート22](./images01/g22.jpg)

X や虎威に登録が必要ですので、ウェブアプリの URL をコピーします。
![Googleシート23](./images01/g23.jpg)

以上で、Google シートの設定は完了です。<br />
お疲れ様でした。
